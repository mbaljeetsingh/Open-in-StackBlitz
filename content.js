// StackBlitz Logo
const SVG = `
<svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" width="18px" height="18px" viewBox="0 0 128 128" enable-background="new 0 0 128 128" xml:space="preserve">  <image id="image0" width="128" height="128" x="0" y="0"
    xlink:href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAQAAABpN6lAAAAABGdBTUEAALGPC/xhBQAAACBjSFJN
AAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAJcEhZ
cwAADsQAAA7EAZUrDhsAAAAHdElNRQfiChQCAhu5RLdAAAAMGElEQVR42u2ce3BU9RXHP7sbEh5J
CEiMgxNEOihFUBSiNrVFqtWZWnXK2FIIkBCWTJoxVIwBCc/wFAMqtCBjoaBjENDaqdjXdFAyw2AR
MhMaGh4BjKTiCAwEycsku7/+sZuw2eze39ndu1wc9/AP995fzp7v93d+55zf416b4rstdqsNsFpi
BFhtgNUSI8BqA6yWGAFWG2C1xAiw2gCrJUaA1QZYLTECrDbAaokRYLUBVkuMAKsNsFpiBERVe7xJ
etYxJ1omxkUNfCE2NpqiaS8TeDtqdqro/JuuvlIbTdH0slLKrcZEyc4oEeBU51WTmm+CpiLlVkpt
USinyv22EDBdnVfN6ooqiVjTU6pdKeVWAxWqQjUo57eBgImqXjWqBhMIGKtalVJK1SrUo+oL1aLq
1TNm22t2FshiPSm0m6BpKBUkAPACkEV/WknhVaaba7C5BORSxgA6TNDUnyr6AdDAXkYyATfQwQDW
4LxRCchjFcmm9H4ip+nv/f8OGsnhJtwAtJPECjMpMI+ALJaQaBL8M9zk/X8LL5HKzz3xyktBIqVk
3WgEOCkzqff7UEtq19Uh6rmHNODaLm47yZSZ5QXmVIJOVpjU+/Gc4JauKxfrgWk4cGPzadVBMiuB
LZH/oBkeMIllJsGHatJ9rj7nfYbyKA5vBLgm7fRjOZNvBAKcrCPJJPiV3NHt+q/AL0joAd9DQSIv
Rx4LIiUgn5WkmJL44GPu63bdxGxgKgl+A6BTOkhhHQVWEuBkKf1M6v1/8LDfnUrASbpPBuhJQSJL
IguHkRCQQ6lpY38bj/vdcZGNg1n0pSNg/3uknX4sI8cKAnJZaVLigxKye9w7Th19cGPDjtFBpnaS
WEnu9SZgA2UkmTT281keoI+LgUaKqcahocCTFMOMBeERUMh0+mjg24QLYllsDGDFZfYBsJ9fUyWg
IInF4cWCcAjIZT52Wg1GpsKGjTaBrofYHtCGDbR4/1dHLrVaCjyxIAwKQicgjxUk4TKEb8fOKfZo
dWWyN2At2sZOn6taZnFS5AXLyYs2AU5KSTZ0fg/8GmZQrdH1AB8FGSZ/53i360qmcRS7gIKQvSA0
AvSJT2HHQTWTqNLoymCfd8HDX9wB1oBr+BVHhAMhpIxgC+GobCHzNZFfYSeO40ymVqNrBIe9Cx49
5QzfC3h/OOV8H1eQurBT4rjKS2yQgpJ7QD4LBc7v4BhOLfyhfBIUPuwOcr+WmdSIkuICeVKUeoCT
5SQK4P+XHL/x21PSOMqgoE8vc4tB/hjOm4zCrfWCRpbwhgSYzAOclArgx3FMAD+eTw3gw6eG6bOW
qdQQp/WCRJbKMoJjqb5NAUsFY9/BSfK1kR8Oc6fB03YmcNXw7y9zmEwG4ak2gombPvyQq1TqzNF7
QAGLBb1v5yhZ+p+jgjGGz89yTqujislU48Ah8AJtLNARkMdC+ongT9c6P/yNHxs+V8zV6gCoZRr/
EdQFySzSDQTjIFhIiSj0HSNLG/lhm3baepmBIgIAhvM2IwVJsZHVRknRyAMKWShy/pPMFMBfLJi1
LxHDh1pmcEKQFBNZwOzgDYJ7QJ4o9Nk5Qq4A/nxWGvYUQDvpfBUCBTCarYzAjXEuj6ORUjYHfhjM
AwqFkf8o2QL4RQL48GGI8KGaLE7g0OjuIJHFFAZ+GNgDiphLX9HYl4S+2bwmgN9KKo0hEgCQwZsM
oUPrBc2UsVZGQCELRFOeGpyCvJ/H66Jyq4XTJAiI8vx+Ar15hTUAjGcTQ7ThsBdNrOB3PZnxlwLm
a1Z6PWNfUvTCZDYJq80+jBK1uyadc8kKctjMcDCkoJ2+lIA/Bf4eIE181aKx/wR/pleIsGSieI1i
XF3XI9jKaJThQk3ApNi9FC7iRWHVJ4E/nj2mHZTzt2IV87qN+ovs4wfcgq5A7s2DwIFrt3w9YA4l
9NYuddqpJos6rZHDqCIpKvBhLcUB7qazgzGC0qiVVbzaeXnNA2bzoiby4w192ZzRmphGZQhVXWiy
nqKA979mP5mkYTPMCG7iuR8X//ZcdnpAEcWamt/T+8fIFoS+RI5za5Tgb2eGwdPhvMVdgtKoiTLW
dRKQymqe1Pa+DTjAs4LehyPcHSX4H/GIpsUwtjJG4wUeCjazlkY7cCcTSMSl+RMbbt4Xwa+IGvxP
tfDhDAtoEpTdyczkbk8p/AlzqMOhyddu7BTxjNaAf2qmvOHLKTIFrdKYR19NZyriaeVtDl+LAQ+x
mdu0XtCLSzzPewYt/sTEKME/xxguCODvZJwGhyKeNtZ46sjOXt9PHp8LphUDKDOAuDtq8C+SIYbv
DniiJCB839ngAfI5h8MwfCg6GEQZTwV8uo1fRgl+Mz8SLJUN5B3G4dZs23WD3306vJ88bywwciAX
N7M+QCx4PZJjCobSxs8EqTeN98gIFX7PuUAGW7ldM4ZsxHGBYp9YEE+5IDyGC/8xKrStBlNOBi4t
/G9Y5cn/neIf+Q8xi880sUDRziDW+pzQepiJgHyXTd6ygydF8N9hXDjwA68HZLKFIXRoa+rLLGY7
ACNZwRUu4hDCqiePEYJ2LibygbZVGrsZq7HXA3/FtTmAEQEwno3cJlhiuEQxu4SgfaU/X9JH28rN
FIH2NHYxVmNrkN6HYGuCFczkjLY0amcAq5kUBgHlAviKQiH8ceHDN1oVloVDBxd4SbYN2SWpfKFd
JlE8J9jilkyAPfBLg2kL3seHKOCsNhx2kEop+SERMFWwSrRWAH8w5dwrgN9mtDVivDP0AH/QegHE
0cALIcSCSwzQtChnqlZLGu9xryD0tbOepcHVGI/yg8ykTlAgp7BaXASPJkXTYo8I/m4R/A42G8GX
HJDIZAvpGkez4eAiCykXEFCtWf2tZJxWx2B2cp8AfhubWGisSnJC5AHeYJiAgiss1b7CkEa9YQQ4
yWjt+cJ0dnG3AH4rqwNHfl+RrNkfJJfTmqSo6CCFhdqkuMkQ/ucC+IPZKYRfqocvPyOUwTbBekEc
F1jAO0Gf9+csyUGfnucOrmjh7xKN/RaWsEkCTHpK7BAzqSdOGw5TWWNwTm+JAfxLjNLCT+ddIfxF
MvihHJM7iJNT2LUUDGRp0Jnh40H/7gojtQseaezkHpHzLwq2GR4JAXCAadqZoqdAXsPTAZ5MDDoB
amSMdms8lXdF8FsokcMP9ahsNU5vXaBfMuk5EKYG+bVm7tPuNA3lL6LE18L80ArzUI7KemQsf2SY
YMnkCqXdTBlBVcCzwa3cr91kH8YORgnhh/guYejH5SvJ5rRgySSZRd2S4pSA8Nt4SHDG4AlGCWr+
MOCH98JEFbM4K8gIKazqKpDj+U2ANm5yBGcLAVyGu76KeJrDgR/uKzOHmKX1Ak8seIUSEoFHul6H
9jW71KBm6K7JSBTxNDE3vBdpw31p6gBTqRVNlp8lE1jbo6XiNZaF+ev+8JuZ512cu24EQDW5nNEO
BDf/4zAD/V6JBdjB8ybBb2JuuPAje3GyijzDWKBw0MzvucT2HmeR/iWY8krhh937kRIAB5lhUBfY
gDrKocdLsR/zmGnwiyOBH/nL0wfJ5jj2AHoUDtp4ExfL/I7KHOQnJsJ/KzI1kb8+X8k06ogL4AU2
vmEPMKXb3RoeNAl+I89HCt+cDygc9y6cdddlx8Ve6nmaoT53a7nLNPhzRCtQ14EAOEQ2p/1minZc
vAU857NfVBcgG4QjHviyGuK6EACVTOGUX0ao5wjDfRy+nttN+CVP7xeZA9/Mz+jUMIvPuiiwAR9w
gTx6e5+fZ4gp8BP4miIznN9sAqCSHE55k6INxQno+vDVVcFarx68Ip6rPGcefLM/pVXJFG9S7EUd
H/I0NwPQyk+pN0F/Ao38Nqzt2OBi+tfkRqjDqkm1qJcV6rRSSqlv1FMR6ixQDapBNaov1aQb/3N6
qLHqC3VZjVcol1Kqw4SvABaoBtWszpn/Mb1ofVFysnpFoVYppdxqngn68lWz+ioa8KNFAAoVr9qU
UhtM0bVMnVc50bEzel+VvZ929hm9sBaCfMIJMyO/r4S+KCqVgdwqWO2zXKJHwLdEYp/WttoAqyVG
gNUGWC0xAqw2wGqJEWC1AVZLjACrDbBaYgRYbYDVEiPAagOslhgBVhtgtcQIsNoAq+U7T8D/AQRA
yUP3WWGqAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDE4LTEwLTIwVDAyOjAyOjI3LTA3OjAw2sRVbwAA
ACV0RVh0ZGF0ZTptb2RpZnkAMjAxOC0xMC0yMFQwMjowMjoyNy0wNzowMKuZ7dMAAAAASUVORK5C
YII=" />
</svg>
`;

const addButton = () => {
  const files = Array.from(
    document.querySelectorAll('.files .content .js-navigation-open')
  ).map(n => n.innerHTML);

  // No package.json === stop
  if (!files.includes('package.json')) {
    return null;
  }

  // .Get the toolbar
  const toolbar = document.querySelector(
    '.file-navigation.in-mid-page.d-flex.flex-items-start'
  );
  // Get everything after https://github.com/
  const URL = window.location.pathname;

  // Create the button
  const button = document.createElement('a');
  button.setAttribute('href', `https://stackblitz.com/github${URL}`);
  button.setAttribute('target', '_blank');
  button.setAttribute('rel', 'noopener noreferrer');

  button.classList.add(
    'btn',
    'btn-sm',
    'btn-primary',
    'open-stackblitz-chrome-extension'
  );
  button.innerHTML = `
  ${SVG}
  Open in StackBlitz
`;

  // Add it to the DOM
  return toolbar.append(button);
};
addButton();
